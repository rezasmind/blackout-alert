# محافظ برق - PowerGuard

یک برنامه کاربردی سبک و کاربرپسند برای ویندوز که از از دست رفتن داده‌ها در هنگام قطعی برق برنامه‌ریزی شده جلوگیری می‌کند.

## ویژگی‌ها

### ویژگی‌های اصلی (MVP)
- ✅ **اجرای خودکار با ویندوز**: برنامه به طور خودکار با شروع ویندوز اجرا می‌شود
- ✅ **عملکرد در سیستم تری**: برنامه در پس‌زمینه اجرا شده و در نوار وظیف نمایش داده نمی‌شود
- ✅ **رابط ساده تنظیم زمان**: امکان تنظیم آسان زمان قطعی برق
- ✅ **هشدار قبل از خاموشی**: هشدار 7 دقیقه‌ای قبل از خاموشی سیستم
- ✅ **خاموشی خودکار سیستم**: خاموشی ایمن سیستم 5 دقیقه قبل از قطعی برق

### ویژگی‌های پیشرفته
- ✅ **تایمرهای قابل تنظیم**: امکان تغییر زمان هشدار و خاموشی
- ✅ **قابلیت لغو/تأخیر**: امکان لغو خاموشی در هر مرحله
- ✅ **نمایش شمارش معکوس**: نمایش زمان باقی‌مانده تا خاموشی
- ✅ **برنامه‌های تکراری**: امکان تنظیم برنامه روزانه یا هفتگی
- ✅ **یادآوری هوشمند**: یادآوری خودکار برای تنظیم زمان قطعی
- ✅ **پشتیبانی از زبان فارسی**: رابط کاربری کاملاً فارسی با پشتیبانی RTL
- ✅ **ثبت رویدادها**: ثبت تمام فعالیت‌های برنامه برای عیب‌یابی

## نحوه استفاده

### اولین اجرا
1. برنامه را اجرا کنید
2. صفحه خوش‌آمدگویی نمایش داده می‌شود
3. گزینه "شروع خودکار با ویندوز" را انتخاب کنید
4. روی "شروع کنید" کلیک کنید

### تنظیم تایمر خاموشی
1. روی آیکون برنامه در سیستم تری کلیک کنید
2. زمان قطعی برق را انتخاب کنید
3. روی "تنظیم تایمر خاموشی" کلیک کنید
4. برنامه در پس‌زمینه منتظر زمان تعیین شده خواهد ماند

### تنظیمات پیشرفته
1. روی آیکون برنامه در سیستم تری راست‌کلیک کنید
2. "تنظیمات" را انتخاب کنید
3. تنظیمات مورد نظر خود را تغییر دهید:
   - زمان هشدار (پیش‌فرض: 7 دقیقه)
   - زمان خاموشی (پیش‌فرض: 5 دقیقه)
   - یادآوری هوشمند
   - برنامه‌های تکراری

## ساختار پروژه

```
PowerGuard/
├── Form1.cs                    # فرم اصلی برنامه
├── Form1.Designer.cs           # طراح فرم اصلی
├── Program.cs                  # نقطه ورود برنامه
├── Models/
│   └── AppSettings.cs          # مدل تنظیمات برنامه
├── Services/
│   ├── Logger.cs               # سرویس ثبت رویدادها
│   ├── StartupManager.cs       # مدیریت استارت‌آپ ویندوز
│   ├── ShutdownService.cs      # سرویس خاموشی سیستم
│   └── NotificationService.cs  # سرویس اعلان‌ها
├── Forms/
│   ├── WelcomeForm.cs          # فرم خوش‌آمدگویی
│   ├── SettingsForm.cs         # فرم تنظیمات
│   └── ShutdownWarningForm.cs  # فرم هشدار خاموشی
└── Resources/
    ├── Strings.resx            # منابع متنی فارسی
    └── Strings.Designer.cs     # کلاس منابع تولید شده
```

## الزامات سیستم

- ویندوز 10 یا 11
- .NET 8.0 Runtime
- دسترسی مدیر برای خاموشی سیستم (UAC)

## نصب و اجرا

### از کد منبع
```bash
# کلون کردن پروژه
git clone <repository-url>
cd PowerGuard

# ساخت پروژه
dotnet build

# اجرای برنامه
dotnet run
```

### ساخت فایل اجرایی
```bash
# ساخت فایل اجرایی مستقل
dotnet publish -c Release -r win-x64 --self-contained true -p:PublishSingleFile=true
```

## فایل‌های تنظیمات و لاگ

برنامه فایل‌های زیر را در پوشه `%APPDATA%\PowerGuard\` ایجاد می‌کند:

- `settings.json`: تنظیمات برنامه
- `log.txt`: فایل ثبت رویدادها

## امنیت

- برنامه از دستورات استاندارد ویندوز برای خاموشی استفاده می‌کند
- تمام تنظیمات به صورت محلی ذخیره می‌شوند
- هیچ اطلاعاتی به اینترنت ارسال نمی‌شود

## عیب‌یابی

اگر برنامه به درستی کار نمی‌کند:

1. فایل `%APPDATA%\PowerGuard\log.txt` را بررسی کنید
2. مطمئن شوید که برنامه با دسترسی مدیر اجرا می‌شود
3. تنظیمات فایروال و آنتی‌ویروس را بررسی کنید

## مشارکت

برای گزارش باگ یا درخواست ویژگی جدید، لطفاً یک Issue ایجاد کنید.

## مجوز

این پروژه تحت مجوز MIT منتشر شده است.

---

**نکته مهم**: این برنامه برای کمک به کاربرانی طراحی شده که با قطعی برق برنامه‌ریزی شده مواجه هستند. لطفاً قبل از استفاده، تمام کارهای مهم خود را ذخیره کنید.
